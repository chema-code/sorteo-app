{"version":3,"sources":["Utils/SorteoFunctions.js","componets/Progress_bar.js","componets/SorteoScreen.js","hooks/useForm.js","SorteosApp.js","index.js"],"names":["pause","t","Promise","resolve","reject","setTimeout","Sortear","data","premios","min","max","setParentProgress","a","log","numerosGanadores","ganadores","console","valorProgreso","valorOrginalPremios","addLog","progreso","numeroPremiado","getRandomInt","undefined","concursante","buscarConcursante","buscarPremiado","totalPremios","idacomp1","idacomp2","idacomp3","addToGanadores","substractPremio","idsolicitante","Sortear2","campo","listaPremios","i","length","valor","eval","indiceASeleccionar","splice","Math","round","random","res","find","c","toString","premio","text","texto","Date","toISOString","cantidad","Progress_bar","bgcolor","progress","Parentdiv","height","width","backgroundColor","borderRadius","margin","Childdiv","textAlign","style","padding","color","fontWeight","SorteoScreen","useState","parsed","setParsed","hasData","setHashData","finSorteo","setFinSorteo","sorteoData","setSorteoData","uploadFile","useRef","showProgessBar","setShowProgressBar","setProgress","useEffect","initialState","values","setValues","target","name","value","useForm","NumPremios","NumMinSorteo","NumMaxSorteo","formRegisterValues","handleRegisterInputChange","handleSortear","sorteoFinalizado","className","id","type","onChange","placeholder","autoComplete","required","cclassNamelass","ref","current","files","d3","disabled","class","htmlFor","onClick","window","print","scope","map","oRow","SorteosApp","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.7175604c.chunk.js","sourcesContent":["export function pause(t) {\r\n    var promise = new Promise(\r\n                   function (resolve, reject) {\r\n              setTimeout(\r\n              function () { \r\n                   resolve();\r\n              }, t); \r\n    });\r\n    return promise;\r\n  }\r\n\r\nexport const  Sortear = async (data, premios, min, max, setParentProgress) => {\r\n    //return new Promise(resolve => {\r\n    let log = [];\r\n    let numerosGanadores = [];\r\n    let ganadores = [];\r\n    console.log('valores', premios, min, max);\r\n\r\n    const valorProgreso = 100 / premios;\r\n    const valorOrginalPremios = premios;\r\n    while (premios > 0) {\r\n\r\n        log = addLog(log, `Inicio sorteo.`)\r\n        const progreso = valorProgreso * (valorOrginalPremios - premios);\r\n        console.log('progreso', progreso);\r\n        setParentProgress(progreso);\r\n        console.log('premios', premios);\r\n\r\n        const numeroPremiado = getRandomInt(min, max)\r\n        //console.log('numeroPremiado', numeroPremiado);\r\n\r\n        log = addLog(log, `Número (${numeroPremiado})`)\r\n        const concursante = buscarConcursante(data, numeroPremiado);\r\n\r\n        //console.log('concursante', concursante);\r\n\r\n        if (concursante === undefined) {\r\n            log = addLog(log, `Número (${numeroPremiado}) no encontrados entre los concursantes.`);\r\n            continue;\r\n        }\r\n        if (buscarPremiado(numerosGanadores, numeroPremiado)) {\r\n            log = addLog(log, `Número (${numeroPremiado}) ya premiado.`);\r\n            continue;\r\n        }\r\n        \r\n        let totalPremios = 1;\r\n        if (concursante.idacomp1 > 0) {\r\n            totalPremios++;\r\n        }\r\n        if (concursante.idacomp2 > 0) {\r\n            totalPremios++;\r\n        }\r\n        if (concursante.idacomp3 > 0) {\r\n            totalPremios++;\r\n        }\r\n\r\n        if (premios >= totalPremios) {\r\n            numerosGanadores = addToGanadores(numerosGanadores, numeroPremiado);\r\n\r\n            premios = substractPremio(premios, 1);\r\n            ganadores = addToGanadores(ganadores, concursante.idsolicitante);\r\n            log = addLog(log, `Agregar ganador (${numeroPremiado}) premiado, idUnico:${concursante.idsolicitante} quedan ${premios}.`)\r\n\r\n            if (concursante.idacomp1 > 0) {\r\n                ganadores = addToGanadores(ganadores, concursante.idacomp1);\r\n                premios = substractPremio(premios, 1);\r\n                log = addLog(log, `Agregar ganador acompañante(${concursante.idacomp1}) premiado, quedan ${premios}.`)\r\n            }\r\n            if (concursante.idacomp2 > 0) {\r\n                ganadores = addToGanadores(ganadores, concursante.idacomp2);\r\n                premios = substractPremio(premios, 1);\r\n                log = addLog(log, `Agregar ganador acompañante (${concursante.idacomp3}) premiado, quedan ${premios}.`)\r\n            }\r\n            if (concursante.idacomp2 > 0) {\r\n                ganadores = addToGanadores(ganadores, concursante.idacomp3);\r\n                premios = substractPremio(premios, 1);\r\n                log = addLog(log, `Agregar ganador acompañante (${concursante.idacomp3}) premiado, quedan ${premios}.`)\r\n            }\r\n\r\n            //log = addLog(log, `Número (${numeroPremiado}) premiado, quedan ${premios}.`)\r\n        }\r\n        else{\r\n            log = addLog(log, `Saltamos el número (${numeroPremiado}) porque no quedan suficientes premios, hay:${premios} y se solicitan: ${totalPremios}.`)\r\n        }\r\n        \r\n        await pause(1);\r\n        \r\n    }\r\n    \r\n    log = addLog(log, `Fin sorteo.`)\r\n    return [log, ganadores, numerosGanadores];\r\n    //resolve([log, ganadores]);\r\n//})\r\n}\r\n\r\nexport const  Sortear2 = async (data, premios, min, max, setParentProgress) => {\r\n    //return new Promise(resolve => {\r\n    let log = [];\r\n    let numerosGanadores = [];\r\n    let ganadores = [];\r\n    console.log('valores', premios, min, max);\r\n\r\n    const campo = \"idsolicitante\";\r\n\r\n    let listaPremios = [premios];\r\n  \r\n    for(var i = 0; i < data.length; i++){\r\n        const valor =eval('data[' + i +'].'+ campo);\r\n        console.log(\"valor_\" + i, valor);\r\n        listaPremios[i] = valor;\r\n        \r\n    }\r\n    \r\n    const valorProgreso = 100 / premios;\r\n    const valorOrginalPremios = premios;\r\n    \r\n    log = addLog(log, `Inicio sorteo.`)\r\n\r\n    while (premios > 0) {\r\n\r\n       \r\n        const progreso = valorProgreso * (valorOrginalPremios - premios);\r\n        \r\n        console.log('progreso', progreso);\r\n        setParentProgress(progreso);\r\n        console.log('premios', premios);\r\n\r\n        const indiceASeleccionar = getRandomInt(1, listaPremios.length-1);\r\n        const numeroPremiado = listaPremios[indiceASeleccionar];\r\n        \r\n        \r\n        // console.log('listaPremios',listaPremios);\r\n        // console.log('indiceASeleccionar',indiceASeleccionar);\r\n        // console.log('listapremios.length', listaPremios.length);\r\n        // console.log('numeroPremiado',numeroPremiado);\r\n\r\n        log = addLog(log, `Número seleccionado: (${numeroPremiado})`)\r\n        const concursante = buscarConcursante(data, numeroPremiado);\r\n\r\n        //console.log('concursante', concursante);\r\n\r\n        if (concursante === undefined) {\r\n            log = addLog(log, `Número (${numeroPremiado}) no encontrados entre los concursantes.`);\r\n            continue;\r\n        }\r\n        if (buscarPremiado(numerosGanadores, numeroPremiado)) {\r\n            log = addLog(log, `Número (${numeroPremiado}) ya premiado.`);\r\n            continue;\r\n        }\r\n        \r\n        let totalPremios = 1;\r\n        if (concursante.idacomp1 > 0) {\r\n            totalPremios++;\r\n        }\r\n        if (concursante.idacomp2 > 0) {\r\n            totalPremios++;\r\n        }\r\n        if (concursante.idacomp3 > 0) {\r\n            totalPremios++;\r\n        }\r\n\r\n        if (premios >= totalPremios) {\r\n            listaPremios.splice(indiceASeleccionar,1);\r\n\r\n            numerosGanadores = addToGanadores(numerosGanadores, numeroPremiado);\r\n\r\n            premios = substractPremio(premios, 1);\r\n            ganadores = addToGanadores(ganadores, concursante.idsolicitante);\r\n            log = addLog(log, `Agregar ganador (${numeroPremiado}) premiado, idUnico:${concursante.idsolicitante} quedan ${premios}.`)\r\n\r\n            if (concursante.idacomp1 > 0) {\r\n                ganadores = addToGanadores(ganadores, concursante.idacomp1);\r\n                premios = substractPremio(premios, 1);\r\n                log = addLog(log, `Agregar ganador acompañante(${concursante.idacomp1}) premiado, quedan ${premios}.`)\r\n            }\r\n            if (concursante.idacomp2 > 0) {\r\n                ganadores = addToGanadores(ganadores, concursante.idacomp2);\r\n                premios = substractPremio(premios, 1);\r\n                log = addLog(log, `Agregar ganador acompañante (${concursante.idacomp3}) premiado, quedan ${premios}.`)\r\n            }\r\n            if (concursante.idacomp2 > 0) {\r\n                ganadores = addToGanadores(ganadores, concursante.idacomp3);\r\n                premios = substractPremio(premios, 1);\r\n                log = addLog(log, `Agregar ganador acompañante (${concursante.idacomp3}) premiado, quedan ${premios}.`)\r\n            }\r\n\r\n            //log = addLog(log, `Número (${numeroPremiado}) premiado, quedan ${premios}.`)\r\n        }\r\n        else{\r\n            log = addLog(log, `Saltamos el número (${numeroPremiado}) porque no quedan suficientes premios, hay:${premios} y se solicitan: ${totalPremios}.`)\r\n        }\r\n        \r\n        await pause(1);\r\n        \r\n    }\r\n    \r\n    log = addLog(log, `Fin sorteo.`)\r\n    return [log, ganadores, numerosGanadores];\r\n    //resolve([log, ganadores]);\r\n//})\r\n}\r\n\r\n\r\n\r\nconst getRandomInt = (min, max) => {\r\n    return Math.round(Math.random() * (max - min)) + min;\r\n}\r\nconst buscarConcursante = (data, concursante) => {\r\n\r\n    const campo = \"idsolicitante\";\r\n    const res = data.find(c => eval('c.' + campo) === concursante.toString());\r\n    return res;\r\n}\r\n\r\nconst buscarPremiado = (data, concursante) => {\r\n\r\n    const res = data.find(c => c === concursante.toString());\r\n    if (res === undefined) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n\r\nconst addToGanadores = (premios, premio) => {\r\n    return [...premios, premio.toString()];\r\n};\r\n\r\nconst addLog = (log, text) => {\r\n    const fecha = new Date();\r\n    const texto = fecha.toISOString('es-ES') + \" \" + text\r\n    return [...log, texto];\r\n};\r\n\r\nconst substractPremio = (premio, cantidad) => {\r\n    return (premio - cantidad);\r\n};","import React from 'react'\r\n\r\nconst Progress_bar = ({bgcolor,progress,height}) => {\r\n\t\r\n\tconst Parentdiv = {\r\n\t\theight: height,\r\n\t\twidth: '80%',\r\n\t\tbackgroundColor: 'whitesmoke',\r\n\t\tborderRadius: 40,\r\n\t\tmargin: 50\r\n\t}\r\n\t\r\n\tconst Childdiv = {\r\n\t\theight: '100%',\r\n\t\twidth: `${progress}%`,\r\n\t\tbackgroundColor: bgcolor,\r\n\tborderRadius:40,\r\n\t\ttextAlign: 'right'\r\n\t}\r\n\t\r\n\tconst progresstext = {\r\n\t\tpadding: 10,\r\n\t\tcolor: 'black',\r\n\t\tfontWeight: 900\r\n\t}\r\n\t\t\r\n\treturn (\r\n\t<div style={Parentdiv}>\r\n\t<div style={Childdiv}>\r\n\t\t<span style={progresstext}>{`${progress}%`}</span>\r\n\t</div>\r\n\t</div>\r\n\t)\r\n}\r\n\r\nexport default Progress_bar;\r\n","import React, { useRef, useState, useEffect } from 'react';\r\nimport * as d3 from 'd3';\r\n\r\n\r\n\r\nimport { useForm } from '../hooks/useForm';\r\n//import { PDFDownloadLink, BlobProvider } from '@react-pdf/renderer';\r\n//import { PdfExport } from './PdfExport';\r\nimport Progress_bar from './Progress_bar';\r\nimport { pause, Sortear2 } from '../Utils/SorteoFunctions';\r\n//import { doc, generarPdf } from './Pdf_jspdf';\r\n\r\n\r\n//import * as  pdfKit from 'pdfkit';\r\n\r\nexport const SorteoScreen = () => {\r\n    const [parsed, setParsed] = useState([]);\r\n    const [hasData, setHashData] = useState(false);\r\n    const [finSorteo, setFinSorteo] = useState(false);\r\n    const [sorteoData, setSorteoData] = useState();\r\n    const uploadFile = useRef(null);\r\n    const [showProgessBar, setShowProgressBar] = useState(true);\r\n    const [progress, setProgress] = useState(0);\r\n\r\n    useEffect(() => {\r\n        console.log(parsed);\r\n    }, [parsed])\r\n\r\n    // useEffect(() => {\r\n    //     //console.log(parsed);\r\n    // }, [progress])\r\n\r\n    const handleFiles = () => {\r\n        console.log(uploadFile.current.files);\r\n        (async () => {\r\n            console.log('uploaded!');\r\n            const text = await uploadFile.current.files[0].text();\r\n            const data = await d3.csvParse(text);\r\n            setParsed(data);\r\n            setHashData(true);\r\n        })();\r\n    }\r\n\r\n    const initialRegisterState = {\r\n        NumPremios: 20,\r\n        NumMinSorteo: 1,\r\n        NumMaxSorteo: 200\r\n    }\r\n    const [formRegisterValues, handleRegisterInputChange] = useForm(initialRegisterState);\r\n\r\n    const { NumPremios, NumMinSorteo, NumMaxSorteo } = formRegisterValues;\r\n\r\n    const handleSortear = async () => {\r\n\r\n        setShowProgressBar(true);\r\n        console.log('Empieza Sorteo', NumPremios, NumMinSorteo, NumMaxSorteo);\r\n        const data = await Sortear2(parsed, NumPremios, NumMinSorteo, NumMaxSorteo, setParentProgress)\r\n        setProgress(100);\r\n        setShowProgressBar(false);\r\n        sorteoFinalizado(data);\r\n\r\n    }\r\n    const sorteoFinalizado = async (data) => {\r\n\r\n        console.log(\"fin sorteo\", data);\r\n        await pause(1000);\r\n        setSorteoData(data);\r\n        setFinSorteo(true);\r\n        await pause(1000);\r\n    }\r\n\r\n\r\n    const setParentProgress = async (progress) => {\r\n        console.log('setParentProgress', progress);\r\n        setProgress(Math.round(progress));\r\n\r\n    }\r\n    const handleImprimir = () => {\r\n        window.print();\r\n    }\r\n\r\n    // const handleExportarPDF = () => {\r\n\r\n    // }\r\n\r\n\r\n    return (\r\n\r\n\r\n        <div>\r\n            <h1>Sorteo App v0.6</h1>\r\n            <br></br>\r\n\r\n            <div className=\"container-fluid\">\r\n                <div className=\"row\">\r\n                    <div className=\"col-5\">\r\n                        <div className=\"input-group input-group mb-3\">\r\n                            <div className=\"input-group-prepend\">\r\n                                <span className=\"input-group-text\" id=\"inputGroup-NumPremios\">*Total premios del sorteo</span>\r\n                            </div>\r\n                            <input\r\n                                type=\"text\"\r\n                                name=\"NumPremios\"\r\n                                onChange={handleRegisterInputChange}\r\n                                value={NumPremios}\r\n                                placeholder=\"Total Premios\"\r\n                                autoComplete=\"off\"\r\n                                required\r\n                                className=\"form-control\" aria-label=\"Default\" aria-describedby=\"inputGroup-NumPremios\" />\r\n                        </div>\r\n\r\n                        <div className=\"input-group input-group mb-3\">\r\n                            <div className=\"input-group-prepend\">\r\n                                <span className=\"input-group-text\" id=\"inputGroup-NumMinSorteo\">*Valor inicial del sorteo</span>\r\n                            </div>\r\n                            <input\r\n                                type=\"text\"\r\n                                name=\"NumMinSorteo\"\r\n                                onChange={handleRegisterInputChange}\r\n                                value={NumMinSorteo}\r\n                                placeholder=\"Número inicial sorteo\"\r\n                                autoComplete=\"off\"\r\n                                required\r\n                                className=\"form-control\" aria-label=\"Default\" aria-describedby=\"inputGroup-NumMinSorteo\" />\r\n                        </div>\r\n\r\n\r\n\r\n                        <div className=\"input-group input-group mb-3\">\r\n                            <div cclassNamelass=\"input-group-prepend\">\r\n                                <span className=\"input-group-text\" id=\"inputGroup-NumMaxSorteo\">*Valor máximo del sorteo</span>\r\n                            </div>\r\n                            <input\r\n                                type=\"text\"\r\n                                name=\"NumMaxSorteo\"\r\n                                onChange={handleRegisterInputChange}\r\n                                value={NumMaxSorteo}\r\n                                placeholder=\"Número máximo sorteo\"\r\n                                autoComplete=\"off\"\r\n                                required\r\n                                className=\"form-control\" aria-label=\"Default\" aria-describedby=\"inputGroup-NumMaxSorteo\" />\r\n                        </div>\r\n\r\n\r\n                        {/* <div class=\"input-group input-group mb-3\">\r\n                    <div class=\"input-group-prepend\">\r\n                        <span class=\"input-group-text\" id=\"inputGroup-FileUpload\">Fichero CSV con las participaciones</span>\r\n                    </div>\r\n                   <input ref={uploadFile} onChange={handleFiles} type=\"file\" id=\"input\"   \r\n                    aria-label=\"Default\" aria-describedby=\"inputGroup-FileUpload\"/>\r\n                </div> */}\r\n\r\n                        <div className=\"input-group mb-3\">\r\n                            <div className=\"input-group-prepend\">\r\n                                <span className=\"input-group-text\">Subir</span>\r\n                            </div>\r\n                            <div className=\"custom-file\">\r\n                                <input required ref={uploadFile} onChange={handleFiles} disabled={hasData}\r\n                                    type=\"file\" id=\"input\" class=\"custom-file-input\" id=\"inputGroupFile01\"></input>\r\n                                <label className=\"custom-file-label\" htmlFor=\"inputGroupFile01\">Elegir Fichero</label>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <hr></hr>\r\n                <div className=\"row\">\r\n                    <div className=\"col-5\">\r\n                        <div>\r\n                            <button\r\n                                type=\"button\"\r\n                                className=\"btn btn-primary\"\r\n                                onClick={handleSortear}\r\n                                disabled={finSorteo} >Iniciar Sorteo\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                {finSorteo ? (\r\n                    <div className=\"row mt-5\">\r\n                        <div className=\"col-5\">\r\n                            <button\r\n                                type=\"button\"\r\n                                className=\"btn btn-primary\"\r\n                                onClick={handleImprimir}\r\n                                disabled={!finSorteo} >Imprimir Resultados\r\n                            </button>\r\n                        </div>\r\n                        {/* <div>\r\n                            <div>\r\n                                {generarPDF()}\r\n                            </div>\r\n                        </div> */}\r\n                        {/* <div className=\"col-5\">\r\n                            <BlobProvider document={<PdfExport dataSorteo={sorteoData} />}>\r\n                                {({ url, loading, error }) => {\r\n                                    if (loading) {\r\n                                        return (\r\n                                            <span>\r\n                                                generating document...\r\n                                            </span>\r\n                                        );\r\n                                        pause(1000);\r\n                                    }\r\n                                    if (!loading && url) {\r\n\r\n                                        return (\r\n                                            <a href={url} download className=\"btn btn-primary\" >\r\n                                                Descargar Resultados\r\n                                            </a>\r\n                                        );\r\n                                    }\r\n                                    if (error) {\r\n                                        console.error(error);\r\n                                        return <p>An error occurred</p>;\r\n                                    }\r\n                                    return null;\r\n                                }}\r\n                            </BlobProvider>\r\n                        </div> */}\r\n\r\n                    </div>) : (<div></div>)}\r\n                <div>\r\n                    <div>\r\n\r\n                        {showProgessBar ? (<Progress_bar bgcolor=\"orange\" progress={progress} height={30} />) : (<div></div>)}\r\n                        {/* {finSorteo ? (\r\n                        <PDFDownloadLink document={<PdfExport dataSorteo={sorteoData}/>} fileName=\"somename.pdf\">\r\n                        {({ blob, url, loading, error }) =>\r\n                            loading ? 'Loading document...' : 'Download now!'\r\n                        }\r\n                        </PDFDownloadLink>\r\n                     ):(<div></div>)} */}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <hr></hr>\r\n            <div className=\"container col-12\">\r\n                <div className=\"row\">\r\n                    <div className=\"card p-1 col-2\">\r\n                        <div className=\"card-body p-1\"> <h2 className=\"card-title text-center\">Paticipaciones</h2>\r\n                            <div>\r\n                                {hasData ? (\r\n\r\n\r\n                                    <table className=\"table table-bordered\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                <th scope=\"col\">Orden</th>\r\n                                                <th scope=\"col\">Participación</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {\r\n                                                parsed.map((oRow, i) => (\r\n                                                    <tr key={\"p\" + i} className={((i % 2) === 0) ? 'table-active' : 'table'}>\r\n                                                        <td className=\"text-right\">{i + 1}\r\n\r\n                                                        </td>\r\n                                                        <td className=\"text-left\"\r\n                                                        >{oRow.idsolicitante}</td>\r\n                                                    </tr>\r\n                                                ))\r\n                                            }\r\n                                        </tbody>\r\n                                    </table>\r\n\r\n                                ) : (\r\n                                    <div></div>\r\n                                )}</div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"card p-1 col-6\">\r\n                        <div className=\"card-body p-1 \"><h2 className=\"card-title text-center\">Sorteo</h2>\r\n                            <div>\r\n                                {sorteoData ? (\r\n                                    <table className=\"table table-bordered\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                <th scope=\"col\">Orden</th>\r\n                                                <th scope=\"col\">Detalle</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {\r\n                                                sorteoData[0].map((oRow, i) => (\r\n                                                    <tr key={\"p\" + i} className={((i % 2) === 0) ? 'table-active' : 'table'}>\r\n                                                        <td className=\"text-right\">{i + 1}\r\n\r\n                                                        </td>\r\n                                                        <td className=\"text-left\"\r\n                                                        >{oRow}</td>\r\n                                                    </tr>\r\n                                                ))\r\n                                            }\r\n                                        </tbody>\r\n                                    </table>\r\n                                ) : (<div></div>)\r\n                                }\r\n\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"card p-1 col-2\">\r\n                        <div className=\"card-body p-1\"><h2 className=\"card-title text-center\">Números</h2>\r\n                            <div>\r\n                                {finSorteo ? (\r\n                                    <table className=\"table table-bordered\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                <th scope=\"col\">Orden</th>\r\n                                                <th scope=\"col\">Número Ganador</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {\r\n                                                sorteoData[2].map((oRow, i) => (\r\n                                                    <tr key={\"p\" + i} className={((i % 2) === 0) ? 'table-active' : 'table'}>\r\n                                                        <td className=\"text-right\">{i + 1}\r\n\r\n                                                        </td>\r\n                                                        <td className=\"text-right\"\r\n                                                        >{oRow}</td>\r\n                                                    </tr>\r\n                                                ))\r\n                                            }\r\n                                        </tbody>\r\n                                    </table>\r\n                                ) : (<div></div>)\r\n                                }\r\n\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"card p-1 col-2\">\r\n                        <div className=\"card-body p-1\"><h2 className=\"card-title text-center\">Abonados</h2>\r\n                            <div>\r\n                                {finSorteo ? (\r\n\r\n                                    <table className=\"table table-bordered\">\r\n                                        <thead>\r\n                                            <tr>\r\n                                                <th scope=\"col\">Orden</th>\r\n                                                <th scope=\"col\">Id Unico</th>\r\n                                            </tr>\r\n                                        </thead>\r\n                                        <tbody>\r\n                                            {\r\n                                                sorteoData[1].map((oRow, i) => (\r\n                                                    <tr key={\"p\" + i} className={((i % 2) === 0) ? 'table-active' : 'table'}>\r\n                                                        <td className=\"text-right\">{i + 1}\r\n\r\n                                                        </td>\r\n                                                        <td className=\"text-right\"\r\n                                                        >{oRow}</td>\r\n                                                    </tr>\r\n                                                ))\r\n                                            }\r\n                                        </tbody>\r\n                                    </table>\r\n\r\n                                ) : (<div></div>)\r\n                                }\r\n\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n\r\n\r\n    )\r\n};\r\n","import { useState } from \"react\"\r\n\r\n\r\nexport const useForm = ( initialState = {} ) => {\r\n  \r\n    const [values, setValues] = useState(initialState);\r\n\r\n    const reset = () => {\r\n        setValues(initialState);\r\n    };\r\n\r\n    const handleInputChange = ({target}) =>{\r\n        \r\n        setValues({\r\n            ...values,\r\n            [target.name]: target.value\r\n        })\r\n    };\r\n\r\n    return [values, handleInputChange, reset];\r\n\r\n};","import React from 'react'\r\nimport { SorteoScreen } from './componets/SorteoScreen.js'\r\n\r\nexport const SorteosApp = () => {\r\n    return (\r\n        <div>\r\n            <SorteoScreen/>\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport {SorteosApp} from './SorteosApp.js'\n\nReactDOM.render(\n  <React.StrictMode>\n    <SorteosApp />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}